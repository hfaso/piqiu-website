import{r as l,P as g,j as e,C as j,a as m,u as b}from"./index-D7YqWKYN.js";function R({source:s}){const a=l.useRef(null),n=l.useRef(null),t=l.useRef(null),[f,u]=l.useState(!1),c=l.useRef(0);return l.useEffect(()=>{if(!a.current)return;const r=a.current;r.width=window.innerWidth*.5,r.height=window.innerHeight*.5;const i=new g(r,{width:r.width,height:r.height});return n.current=i,i.addGeneralEventListener(),()=>{t.current&&(URL.revokeObjectURL(t.current),t.current=null);try{i.removeGeneralEventListener(),i.dispose()}catch{}}},[]),l.useEffect(()=>{if(!n.current)return;const r=n.current;let i=!1,d;return t.current&&(URL.revokeObjectURL(t.current),t.current=null),s?typeof s=="string"?d=s:(t.current=URL.createObjectURL(s),d=t.current):d="/piqiu-website/models/bird.glb",(async()=>{const h=++c.current,p=new m;console.log("LoaderModel: start loading",d),u(!0);try{const o=r.model;o&&typeof o.clear=="function"&&o.clear()}catch{}try{const o=await p.load(r.renderContext,d);if(i||n.current!==r||h!==c.current)return;for(const x of o)r.addPart(x);r.updateCamera()}catch{}finally{!i&&n.current===r&&h===c.current&&u(!1)}})(),()=>{i=!0}},[s]),e.jsxs("div",{className:"canvas-stage",children:[e.jsx("canvas",{ref:a,id:"demo"}),e.jsx(j,{loading:f})]})}function L(){const[s,a]=l.useState(null),{t:n}=b(),t=l.useRef(null);function f(u){const c=u.target.files&&u.target.files[0];a(c||null)}return e.jsxs("div",{className:"basics-container",children:[e.jsx("h2",{className:"basics-title",children:n("loaderModel.title")}),e.jsx("div",{style:{marginBottom:12},children:e.jsxs("div",{style:{display:"flex",alignItems:"center",gap:10,flexWrap:"wrap"},children:[e.jsx("span",{children:n("loaderModel.chooseLocal")}),e.jsx("input",{ref:t,type:"file",accept:".gltf,.glb,model/gltf+json,model/gltf-binary",onChange:f,style:{display:"none"}}),e.jsx("button",{type:"button",onClick:()=>t.current?.click(),style:{background:"rgba(255,255,255,0.06)",color:"inherit",border:"1px solid rgba(255,255,255,0.18)",borderRadius:10,padding:"8px 12px",cursor:"pointer"},children:n("loaderModel.chooseFile")}),e.jsx("span",{style:{opacity:.85},children:s?s.name:n("loaderModel.noFileSelected")})]})}),e.jsx(R,{source:s}),e.jsxs("div",{className:"case-description",children:[e.jsx("p",{children:n("loaderModel.desc")}),e.jsxs("ul",{children:[e.jsx("li",{children:n("basics.controls.rotate")}),e.jsx("li",{children:n("basics.controls.zoom")}),e.jsx("li",{children:n("basics.controls.pan")})]})]})]})}export{L as default};
