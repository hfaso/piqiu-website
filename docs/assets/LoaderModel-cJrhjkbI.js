import{r as l,P as p,j as e,a as x,u as j}from"./index-D0X_Dv_V.js";function g({source:s}){const o=l.useRef(null),r=l.useRef(null),t=l.useRef(null),d=l.useRef(0);return l.useEffect(()=>{if(!o.current)return;const n=o.current;n.width=window.innerWidth*.5,n.height=window.innerHeight*.5;const i=new p(n,{width:n.width,height:n.height});return r.current=i,()=>{t.current&&(URL.revokeObjectURL(t.current),t.current=null);try{i.removeMouseEventListener(),i.dispose()}catch{}}},[]),l.useEffect(()=>{if(!r.current)return;let n;t.current&&(URL.revokeObjectURL(t.current),t.current=null),s?typeof s=="string"?n=s:(t.current=URL.createObjectURL(s),n=t.current):n="/piqiu-website/models/bird.glb",(async()=>{const a=r.current,u=++d.current,f=new x;console.log("LoaderModel: start loading",n);try{const c=a.model;c&&typeof c.clear=="function"&&c.clear()}catch{}const h=await f.load(a.renderContext,n);if(u===d.current){for(const c of h)a.addPart(c);a.updateCamera()}})(),r.current.addGeneralEventListener()},[s]),e.jsx("div",{children:e.jsx("canvas",{ref:o,id:"demo"})})}function m(){const[s,o]=l.useState(null),{t:r}=j(),t=l.useRef(null);function d(n){const i=n.target.files&&n.target.files[0];o(i||null)}return e.jsxs("div",{className:"basics-container",children:[e.jsx("h2",{className:"basics-title",children:r("loaderModel.title")}),e.jsx("div",{style:{marginBottom:12},children:e.jsxs("div",{style:{display:"flex",alignItems:"center",gap:10,flexWrap:"wrap"},children:[e.jsx("span",{children:r("loaderModel.chooseLocal")}),e.jsx("input",{ref:t,type:"file",accept:".gltf,.glb,model/gltf+json,model/gltf-binary",onChange:d,style:{display:"none"}}),e.jsx("button",{type:"button",onClick:()=>t.current?.click(),style:{background:"rgba(255,255,255,0.06)",color:"inherit",border:"1px solid rgba(255,255,255,0.18)",borderRadius:10,padding:"8px 12px",cursor:"pointer"},children:r("loaderModel.chooseFile")}),e.jsx("span",{style:{opacity:.85},children:s?s.name:r("loaderModel.noFileSelected")})]})}),e.jsx(g,{source:s}),e.jsxs("div",{className:"case-description",children:[e.jsx("p",{children:r("loaderModel.desc")}),e.jsxs("ul",{children:[e.jsx("li",{children:r("basics.controls.rotate")}),e.jsx("li",{children:r("basics.controls.zoom")}),e.jsx("li",{children:r("basics.controls.pan")})]})]})]})}export{m as default};
