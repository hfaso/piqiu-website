import{r as i,P as p,j as e,a as x,u as j}from"./index-CDSqYvvF.js";function g({source:l}){const c=i.useRef(null),n=i.useRef(null),t=i.useRef(null),d=i.useRef(0);return i.useEffect(()=>{if(!c.current)return;const r=c.current;r.width=window.innerWidth*.5,r.height=window.innerHeight*.5;const s=new p(r,{width:r.width,height:r.height});return n.current=s,s.addGeneralEventListener(),()=>{t.current&&(URL.revokeObjectURL(t.current),t.current=null);try{s.removeGeneralEventListener(),s.dispose()}catch{}}},[]),i.useEffect(()=>{if(!n.current)return;const r=n.current;let s=!1,a;return t.current&&(URL.revokeObjectURL(t.current),t.current=null),l?typeof l=="string"?a=l:(t.current=URL.createObjectURL(l),a=t.current):a="/piqiu-website/models/bird.glb",(async()=>{const u=++d.current,f=new x;console.log("LoaderModel: start loading",a);try{const o=r.model;o&&typeof o.clear=="function"&&o.clear()}catch{}try{const o=await f.load(r.renderContext,a);if(s||n.current!==r||u!==d.current)return;for(const h of o)r.addPart(h);r.updateCamera()}catch{}})(),()=>{s=!0}},[l]),e.jsx("div",{children:e.jsx("canvas",{ref:c,id:"demo"})})}function R(){const[l,c]=i.useState(null),{t:n}=j(),t=i.useRef(null);function d(r){const s=r.target.files&&r.target.files[0];c(s||null)}return e.jsxs("div",{className:"basics-container",children:[e.jsx("h2",{className:"basics-title",children:n("loaderModel.title")}),e.jsx("div",{style:{marginBottom:12},children:e.jsxs("div",{style:{display:"flex",alignItems:"center",gap:10,flexWrap:"wrap"},children:[e.jsx("span",{children:n("loaderModel.chooseLocal")}),e.jsx("input",{ref:t,type:"file",accept:".gltf,.glb,model/gltf+json,model/gltf-binary",onChange:d,style:{display:"none"}}),e.jsx("button",{type:"button",onClick:()=>t.current?.click(),style:{background:"rgba(255,255,255,0.06)",color:"inherit",border:"1px solid rgba(255,255,255,0.18)",borderRadius:10,padding:"8px 12px",cursor:"pointer"},children:n("loaderModel.chooseFile")}),e.jsx("span",{style:{opacity:.85},children:l?l.name:n("loaderModel.noFileSelected")})]})}),e.jsx(g,{source:l}),e.jsxs("div",{className:"case-description",children:[e.jsx("p",{children:n("loaderModel.desc")}),e.jsxs("ul",{children:[e.jsx("li",{children:n("basics.controls.rotate")}),e.jsx("li",{children:n("basics.controls.zoom")}),e.jsx("li",{children:n("basics.controls.pan")})]})]})]})}export{R as default};
