import{r as l,j as e,u as p}from"./index-BedgtkhE.js";import{P as x,a as j}from"./Piqiu3DRenderer-BKrlRDmh.js";function g({source:s}){const i=l.useRef(null),n=l.useRef(null),t=l.useRef(null),d=l.useRef(0);return l.useEffect(()=>{if(!i.current)return;const r=i.current;r.width=window.innerWidth*.5,r.height=window.innerHeight*.5;const o=new x(r,{width:r.width,height:r.height});return n.current=o,()=>{t.current&&(URL.revokeObjectURL(t.current),t.current=null);try{o.removeMouseEventListener(),o.dispose()}catch{}}},[]),l.useEffect(()=>{if(!n.current)return;let r;t.current&&(URL.revokeObjectURL(t.current),t.current=null),s?typeof s=="string"?r=s:(t.current=URL.createObjectURL(s),r=t.current):r="/piqiu-website/models/bird.glb",(async()=>{const a=n.current,u=++d.current,f=new j;console.log("LoaderModel: start loading",r);try{const c=a.model;c&&typeof c.clear=="function"&&c.clear()}catch{}const h=await f.load(a.renderContext,r);if(u===d.current){for(const c of h)a.addPart(c);a.updateCamera()}})(),n.current.addGeneralEventListener()},[s]),e.jsx("div",{children:e.jsx("canvas",{ref:i,id:"demo"})})}function R(){const[s,i]=l.useState(null),{t:n}=p(),t=l.useRef(null);function d(r){const o=r.target.files&&r.target.files[0];i(o||null)}return e.jsxs("div",{className:"basics-container",children:[e.jsx("h2",{className:"basics-title",children:n("loaderModel.title")}),e.jsx("div",{style:{marginBottom:12},children:e.jsxs("div",{style:{display:"flex",alignItems:"center",gap:10,flexWrap:"wrap"},children:[e.jsx("span",{children:n("loaderModel.chooseLocal")}),e.jsx("input",{ref:t,type:"file",accept:".gltf,.glb,model/gltf+json,model/gltf-binary",onChange:d,style:{display:"none"}}),e.jsx("button",{type:"button",onClick:()=>t.current?.click(),style:{background:"rgba(255,255,255,0.06)",color:"inherit",border:"1px solid rgba(255,255,255,0.18)",borderRadius:10,padding:"8px 12px",cursor:"pointer"},children:n("loaderModel.chooseFile")}),e.jsx("span",{style:{opacity:.85},children:s?s.name:n("loaderModel.noFileSelected")})]})}),e.jsx(g,{source:s}),e.jsxs("div",{className:"case-description",children:[e.jsx("p",{children:n("loaderModel.desc")}),e.jsxs("ul",{children:[e.jsx("li",{children:n("basics.controls.rotate")}),e.jsx("li",{children:n("basics.controls.zoom")}),e.jsx("li",{children:n("basics.controls.pan")})]})]})]})}export{R as default};
